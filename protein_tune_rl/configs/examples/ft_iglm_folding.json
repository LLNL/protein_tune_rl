
{
    "trainer":
    {
        "name": "online_rl_trainer",
        "batch_size": 8,
        "max_length": 22,
        "check_point_freq": 10,
        "total_optimization_steps": 50
    },

    "experiment_directory": "test_run",

    "dataset":
    {
        "name": "infilling",
        "data_directory": "../data/nos_data/training_data.csv",
        "chain" : "HC",
        "region" : "HCDR3"
    },

    "tokenizer":
    {
        "tokenizer_config": "/usr/workspace/vaccines/abag_seq/weights/trained/iglm",
        "padding_side": "left"
    },

    "collator": 
    {
        "name" : "infilling" 
    },

    "policy_model":
    {
        "name": "iglm",
        "path": "/usr/workspace/vaccines/abag_seq/weights/trained/iglm",
        "attn_implementation": "sdpa"
    },

    "KL_penalty":
    {
        "weight": 1e-4,
        "target": null
    },

    "metric":
    [
        {
            "name": "folding_confidence",
            "params":
            {
                "folding_tool": "igfold",
                "options":
                {
                    "num_models": 1,
                    "do_refine": false,
                    "use_openmm": true,
                    "do_renum": false
                }
            }
        }
    ],

    "optimizer":
    {
        "name": "reinforce",
        "learning_rate": 1e-4,
        "entropy_weight": 5e-3
    }
}
